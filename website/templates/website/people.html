{% extends "website/base.html" %}

{% block pagetitle %}People{% endblock %}

{% load static %}
{% load thumbnail %}
{% load cropping %}
{% load ml_tags %}

{% block stylesheets %}
    <link rel="stylesheet" href="{% static 'website/css/people.css' %}">
{% endblock %}


{% block maincarousel %}
    {% comment %} Keep this empty to not have a carousel {% endcomment %}
{% endblock %}

{% block content %}
  <div id="content" class="container">
    <div id="makelab-people" class="makelab-content-container">
      <h1>People</h1>  
      <div class="current-research-group-grid" style="margin-top:20px">
        {% for position in current_members %}
          {% with person=position.person %}
            <div class="person">
              <img class="swap-image" onmouseover="swapImage(this)" onmouseout="swapImage(this)"
                  src="{% thumbnail person.image person.get_thumbnail_size_as_str box=person.cropping crop detail upscale %}" 
                  alt="{{ person.get_full_name }}" 
                  data-alt-src="{% thumbnail person.easter_egg person.get_thumbnail_size_as_str box=person.easter_egg_crop crop detail upscale %}" 
                  width=90%"/>
              
              <div class="person-name">{{ person.get_full_name }}</div>
              {% if person.last_name == "Froehlich" %}
                <div class="person-title">Lab Director</div>
              {% else %}
                <div class="person-title">{{ position.title }}</div>
              {% endif %}
              <div class="person-affiliation">{{ position.get_school_abbreviated }} {{ position.get_department_abbreviated }} </div>
            </div>
          {% endwith %}
        {% endfor %}
      </div>

      {% if graduated_phd_students %}
        <h2 style="margin-top:40px">Graduated PhD Students</h2>
        <div class="graduated-phds-grid" style="margin-top:20px">
          {% for person in graduated_phd_students %}
            <div class="person graduated-phd">
              <img src="{% thumbnail person.image person.get_thumbnail_size_as_str box=person.cropping crop detail upscale %}" 
                  alt="{{ person.get_full_name }}"/> 

              <img class="hover" src="{% thumbnail person.easter_egg person.get_thumbnail_size_as_str box=person.easter_egg_crop crop detail upscale %}" 
                  alt="{{ person.get_full_name }}"/>
              
              <div class="graduated-phd-name">Dr. {{ person.get_full_name }}</div>
              
              {% with position=person.get_latest_phd_student_position %} 
                {% with dissertation=person.get_dissertation %}  
                <div class="person-title">
                  PhD {{ position.get_school_abbreviated }} {{ position.get_department_abbreviated }}, {{ dissertation.date.year }}
                </div>
              
                <div class="dissertation">Dissertation: <a href="{{ dissertation.pdf_file }}">{{ dissertation }}</a></div>
                <div class="next-position">First Position: <a href="{{ person.next_position_url }}">{{ person.next_position }}</a></div>
                {% endwith %}
              {% endwith %}
              {% comment %} <div class="person-title">{{ position.get_department_abbreviated }} {{ position.title }}</div>
              <div class="person-affiliation">{{ position.get_school_abbreviated }}</div> {% endcomment %}
            </div>
          {% endfor %}
        </div>
      {% endif %}
    </div>

    <h2 style="margin-top:40px">Past Members</h2>
    {% for title in sorted_past_member_titles %}
      <h3>{{ title }}s</h3>
      <div class="past-members-grid">
        
          {% for position in map_title_to_past_members|get_item:title %}
          <div class="past-member-grid-item">
            {% comment %} TODO check if high school student and don't print out department {% endcomment %}
            {{ position.person.get_full_name }}, {{ position.get_school_abbreviated }} {{ position.get_department_abbreviated }}, {{position.get_date_range_as_str}}
          </div>
          {% endfor %}
        
      </div>
    {% endfor %}

  </div>

  <script>
    {% comment %} window.onload = function() {
      var images = document.getElementsByClassName('swap-image');
      for (var i = 0; i < images.length; i++) {
          images[i].addEventListener('mouseover', swapImage, false);
          images[i].addEventListener('mouseout', swapImage, false);
      }
    } {% endcomment %}
    
    function swapImage(imgElement) {
      let temp = imgElement.src;
      imgElement.src = imgElement.dataset.altSrc;
      imgElement.dataset.altSrc = temp;
    }
  </script>
{% endblock %}
