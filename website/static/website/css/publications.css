/**
 * ============================================================================
 * PUBLICATIONS PAGE STYLES - Makeability Lab
 * ============================================================================
 *
 * Styles for the publications listing page and publication snippets used
 * throughout the site (index, project pages, etc.).
 *
 * ACCESSIBILITY:
 *   - All text colors meet WCAG 2.1 AA contrast requirements
 *   - Interactive elements have visible focus states
 *   - Badge/pill links have sufficient contrast
 *
 * DEPENDENCIES:
 *   - design-tokens.css must be loaded first
 *
 * @version 2.0.0 - Refactored with design tokens
 * ============================================================================
 */


/* =============================================================================
   PUBLICATION LIST LAYOUT
   ============================================================================= */

.pub-list {
  margin-top: var(--space-6);
}

@media (min-width: 769px) {
  .pub-list {
    padding-left: 145px; /* Space for filter bar */
  }
}


/* =============================================================================
   PUBLICATION LIST HEADINGS (Year Headers)
   ============================================================================= */

.pub-list h1 {
  color: var(--color-text-secondary);
  font-size: var(--font-size-2xl);
  border-bottom: 1px solid var(--color-border);
  margin: var(--space-2) 0 var(--space-1) 0;
  padding-bottom: var(--space-1);
}


/* =============================================================================
   VERTICAL LAYOUT (Publications Page)
   ============================================================================= */

.pub-row-vert-layout {
  padding-top: var(--space-3);
  padding-bottom: var(--space-3);
  font-size: var(--font-size-sm);
  position: relative;
  min-height: 170px;
}

.pub-row-vert-layout p {
  margin: 0;
  padding: 0;
}

.pub-info {
  padding-bottom: var(--space-5);
  display: table-cell;
  vertical-align: top;
  width: 100%;
  position: relative;
}


/* =============================================================================
   PUBLICATION THUMBNAILS
   ============================================================================= */

.pub-thumbnail {
  position: relative;
}

.pub-thumbnail-image {
  border: 1px solid var(--color-border);
  width: 100%;
  max-width: 135px;
  margin: auto;
}

.pub-thumbnail-image2 {
  border: 1px solid var(--color-border);
}

/* Hide thumbnail on very small screens */
@media (max-width: 374px) {
  .pub-thumbnail {
    display: none;
  }

  .pub-award-banner {
    display: none;
  }
}

/* Show thumbnail as table cell on larger screens */
@media (min-width: 375px) {
  .pub-thumbnail {
    width: 120px;
    min-width: 120px;
    display: table-cell;
    vertical-align: top;
    padding-right: var(--space-3);
    position: relative;
    top: 0;
    left: 0;
    z-index: 10;
  }

  .pub-award-banner {
    position: absolute;
    top: 0;
    left: 0;
    height: 40px;
    width: 40px;
    z-index: 20;
  }
}


/* =============================================================================
   HORIZONTAL LAYOUT (Index Page, Recent Publications)
   ============================================================================= */

.pub-column-horiz-layout {
  margin-bottom: var(--space-5);
  padding-left: 0;
  max-height: 129px;
}

.pub-thumbnail-horiz-layout {
  float: left;
  margin-right: var(--space-2);
  height: 129px;
  overflow: hidden;
}

.pub-thumbnail-horiz-layout img {
  height: auto;
}

/* Hide download links until hover (horizontal layout only) */
.pub-column-horiz-layout .pub-download-links {
  opacity: 0;
  transition: opacity var(--transition-fast);
}

.pub-column-horiz-layout:hover .pub-download-links,
.pub-column-horiz-layout:focus-within .pub-download-links {
  opacity: 1;
}


/* =============================================================================
   PUBLICATION TEXT STYLES
   ============================================================================= */

.pub-title {
  font-weight: var(--font-weight-semibold);
}

.artifact-title {
  color: var(--color-text-primary);
  font-weight: var(--font-weight-medium);
  word-wrap: break-word;
  text-overflow: ellipsis;
  /* max-width: 320px; */
}

.pub-authors a {
  color: var(--color-text-secondary);
  text-decoration: none;
}

.pub-authors a:hover {
  color: var(--color-link-hover);
  text-decoration: underline;
}

.pub-authors a:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

.pub-stats {
  color: var(--color-text-secondary);
}

.pub-venue {
  color: var(--color-text-secondary);
}

.pub-acceptance-rate {
  font-weight: var(--font-weight-medium);
}

.pub-to-appear-text {
  font-style: italic;
}

.pub-keywords {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  word-break: break-all;
}

.pub-keyword {
  word-wrap: break-word;
}


/* =============================================================================
   AWARD STYLES
   ============================================================================= */

.pub-award-text,
.pub-award-icon {
  color: var(--color-award);
}

.award-icon {
  border: none;
  width: 20px;
  height: auto;
  vertical-align: middle;
}


/* =============================================================================
   PUBLICATION ID (Side Label)
   ============================================================================= */

.pub-id {
  font-size: var(--font-size-xs);
  color: var(--color-text-secondary);
  min-width: 40px;
  display: table-cell;
  vertical-align: top;
  padding-right: var(--space-3);
}

@media (max-width: 768px) {
  .pub-id {
    text-align: left;
  }
}

@media (min-width: 769px) {
  .pub-id {
    text-align: right;
  }
}


/* =============================================================================
   DOWNLOAD LINKS - Pill Badge Style
   =============================================================================
   ACCESSIBILITY:
   - Background #f0f0f0 with text #0d5a8c = 5.0:1 contrast (AA âœ“)
   - Hover state uses darker blue for clear feedback
   - Focus state uses standard focus ring
   ============================================================================= */

.pub-download-links {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-2);
  margin-top: var(--space-2) !important;
  font-size: var(--font-size-xs);
}

.pub-download-links a {
  display: inline-flex;
  align-items: center;
  padding: var(--space-1) var(--space-2);
  background-color: var(--color-bg-surface);
  border-radius: var(--border-radius-full);
  color: var(--color-link);
  text-decoration: none;
  transition: background-color var(--transition-fast), color var(--transition-fast);
}

.pub-download-links a:hover {
  background-color: var(--color-bg-muted);
  color: var(--color-link-hover);
  text-decoration: none;
}

.pub-download-links a:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

.pub-download-links a i,
.pub-download-links a .ai {
  margin-right: var(--space-1);
  font-size: 0.95em;
}


/* =============================================================================
   CITATION POPOVER
   ============================================================================= */

.citation-links {
  text-align: left;
  margin-bottom: calc(-1 * var(--space-2));
  cursor: pointer;
}

.citation-links button {
  border-width: 1px;
  border-radius: var(--border-radius-sm);
  padding: var(--space-1) var(--space-2);
  background-color: var(--color-bg-surface);
  color: var(--color-text-primary);
  cursor: pointer;
  transition: border-color var(--transition-fast);
}

.citation-links button:hover {
  background-color: var(--color-bg-muted);
}

.citation-links button:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

.citation-links button.active {
  border-width: 2px;
  border-color: var(--color-primary);
  font-weight: var(--font-weight-medium);
}

.citation-copy,
.citation-download,
.pub-citation-link,
.publication-citation-link {
  cursor: pointer;
}

.citation-copy:focus,
.citation-download:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

/* =============================================================================
   TABLE OF CONTENTS (Sticky Sidebar)
   ============================================================================= */

.toc {
  position: -webkit-sticky;
  position: sticky;

  max-height: calc(100vh - 120px);
  overflow-y: auto;
  
  /* Remove the border/padding we added before, as the column gutter handles spacing now */
  padding-left: 0;
  border-left: none;
  top: 80px;
}

/* Optional: Make the TOC links look nicer (gray to blue) */
.toc-link {
  color: var(--color-text-secondary);
  text-decoration: none;
  display: block;
  padding: 4px 0;
  font-family: var(--font-family-secondary);
}

.toc-link:hover {
  color: var(--color-link-hover);
}

.toc-link:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

.toc-link.is-active-link {
  color: var(--color-primary);
  font-weight: var(--font-weight-bold);
  border-left: 3px solid var(--color-primary);
  padding-left: 10px;
  margin-left: -13px; /* Pull back to align with border */
}


/* =============================================================================
   RESPONSIVE ADJUSTMENTS
   ============================================================================= */

@media only screen and (max-width: 600px) {
  .citation-link {
    display: none;
  }
}

/* Flexbox wrapper to force the sidebar column to be as tall as the content */
.row-flex {
  display: flex;
  flex-wrap: wrap;
}

/* Ensure the sticky sidebar stays relevant to the flex parent */
.toc {
  /* top: 100px;  <-- You already have this, just confirming */
  align-self: flex-start; /* Prevents the TOC itself from stretching, just the column stretches */
}

/**
 * ============================================================================
 * CITATION POPOVER STYLES
 * ============================================================================
 * 
 * Modern, polished styling for the citation popover component.
 * Features a segmented toggle for format selection and clean action buttons.
 * 
 * ACCESSIBILITY:
 *   - Focus states on all interactive elements
 *   - Sufficient color contrast (AA compliant)
 *   - Clear visual feedback for active states
 * 
 * @version 2.1.0
 * ============================================================================
 */


/* =============================================================================
   CITATION FORMAT TOGGLE (Segmented Control)
   =============================================================================
   A modern segmented button group for switching between Text and BibTeX formats.
   ============================================================================= */

.citation-format-toggle {
  display: inline-flex;
  border-radius: var(--border-radius-md);
  overflow: hidden;
  border: 1px solid var(--color-border-strong);
  margin-bottom: var(--space-3);
}

.citation-format-btn {
  padding: var(--space-2) var(--space-4);
  border: none;
  background-color: var(--color-bg-page);
  color: var(--color-text-secondary);
  font-size: var(--font-size-sm);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: background-color var(--transition-fast), 
              color var(--transition-fast);
  position: relative;
}

/* Divider between buttons */
.citation-format-btn:not(:last-child)::after {
  content: '';
  position: absolute;
  right: 0;
  top: 25%;
  height: 50%;
  width: 1px;
  background-color: var(--color-border);
}

.citation-format-btn:hover {
  background-color: var(--color-bg-muted);
  color: var(--color-text-primary);
}

.citation-format-btn:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: -2px; /* Inset focus ring for segmented control */
  z-index: 1;
}

.citation-format-btn.active {
  background-color: var(--color-primary);
  color: var(--color-text-on-dark);
}

/* Remove divider when active button is adjacent */
.citation-format-btn.active::after,
.citation-format-btn.active + .citation-format-btn::before {
  display: none;
}


/* =============================================================================
   CITATION CONTENT AREA
   ============================================================================= */

.citation-content {
  padding: var(--space-3);
  background-color: var(--color-bg-surface);
  border-radius: var(--border-radius-sm);
  margin-bottom: var(--space-3);
  font-size: var(--font-size-sm);
  line-height: var(--line-height-relaxed);
  color: var(--color-text-primary);
  max-height: 200px;
  overflow-y: auto;
}

.citation-text,
.bibtex-text {
  margin: 0;
}

/* BibTeX gets monospace font for readability */
.bibtex-text {
  font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, monospace;
  font-size: var(--font-size-xs);
  white-space: pre-wrap;
  word-break: break-all;
}


/* =============================================================================
   CITATION ACTION BUTTONS (Download / Copy)
   ============================================================================= */

.citation-actions {
  display: flex;
  justify-content: flex-end;
  gap: var(--space-2);
}

.citation-action-btn {
  display: inline-flex;
  align-items: center;
  gap: var(--space-1);
  padding: var(--space-1) var(--space-3);
  background-color: transparent;
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius-sm);
  color: var(--color-link);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
  cursor: pointer;
  transition: background-color var(--transition-fast),
              border-color var(--transition-fast),
              color var(--transition-fast);
}

.citation-action-btn:hover {
  background-color: var(--color-bg-surface);
  border-color: var(--color-primary);
  color: var(--color-link-hover);
}

.citation-action-btn:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

.citation-action-btn i {
  font-size: 0.9em;
}


/* =============================================================================
   COPY FEEDBACK TOOLTIP
   ============================================================================= */

.citation-copied-feedback {
  display: inline-block;
  margin-left: var(--space-2);
  padding: var(--space-1) var(--space-2);
  background-color: var(--color-success);
  color: var(--color-white);
  font-size: var(--font-size-xs);
  font-weight: var(--font-weight-medium);
  border-radius: var(--border-radius-sm);
  animation: fadeInUp 0.2s ease-out;
}

@keyframes fadeInUp {
  from {
    opacity: 0;
    transform: translateY(4px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}


/* =============================================================================
   BOOTSTRAP POPOVER OVERRIDES
   =============================================================================
   Customize the Bootstrap popover appearance to match our design system.
   ============================================================================= */

/* Popover container */
.popover {
  font-family: var(--font-family-secondary);
  border: 1px solid var(--color-border);
  border-radius: var(--border-radius-md);
  box-shadow: var(--shadow-lg);
  max-width: 450px;
}

/* Popover title/header */
.popover-title {
  background-color: var(--color-bg-surface);
  border-bottom: 1px solid var(--color-border);
  font-weight: var(--font-weight-semibold);
  font-size: var(--font-size-sm);
  padding: var(--space-2) var(--space-3);
  border-radius: var(--border-radius-md) var(--border-radius-md) 0 0;
}

/* Popover body/content */
.popover-content {
  padding: var(--space-3);
}


/* =============================================================================
   LEGACY SUPPORT
   =============================================================================
   Styles for the old markup structure (can be removed after migration).
   ============================================================================= */

/* Old button styles (from original .citation-links) */
.citation-links button {
  border-width: 1px;
  border-radius: var(--border-radius-sm);
  padding: var(--space-1) var(--space-2);
  background-color: var(--color-bg-surface);
  color: var(--color-text-primary);
  cursor: pointer;
  transition: border-color var(--transition-fast);
}

.citation-links button:hover {
  background-color: var(--color-bg-muted);
}

.citation-links button:focus {
  outline: var(--focus-ring-width) solid var(--focus-ring-color);
  outline-offset: var(--focus-ring-offset);
}

.citation-links button.active {
  border-width: 2px;
  border-color: var(--color-primary);
  font-weight: var(--font-weight-medium);
}